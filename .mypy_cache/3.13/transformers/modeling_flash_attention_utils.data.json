{".class":"MypyFile","_fullname":"transformers.modeling_flash_attention_utils","future_import_flags":[],"is_partial_stub_package":false,"is_stub":false,"names":{".class":"SymbolTable","F":{".class":"SymbolTableNode","cross_ref":"torch.nn.functional","kind":"Gdef"},"FA_VERSION":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.FA_VERSION","name":"FA_VERSION","type":{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}}},"FlashAttentionKwargs":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["typing._TypedDict"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"transformers.modeling_flash_attention_utils.FlashAttentionKwargs","name":"FlashAttentionKwargs","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils.FlashAttentionKwargs","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"transformers.modeling_flash_attention_utils","mro":["transformers.modeling_flash_attention_utils.FlashAttentionKwargs","typing._TypedDict","typing.Mapping","typing.Collection","typing.Iterable","typing.Container","builtins.object"],"names":{".class":"SymbolTable"},"self_type":null,"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":{".class":"TypedDictType","fallback":"typing._TypedDict","items":[["cumulative_seqlens_q",{".class":"UnionType","items":["torch._C.LongTensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],["cumulative_seqlens_k",{".class":"UnionType","items":["torch._C.LongTensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],["max_length_q",{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}],["max_length_k",{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}]],"readonly_keys":[],"required_keys":[]}}},"HAS_FA2":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready","is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.HAS_FA2","name":"HAS_FA2","type":"builtins.bool"}},"HAS_FA3":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready","is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.HAS_FA3","name":"HAS_FA3","type":"builtins.bool"}},"Optional":{".class":"SymbolTableNode","cross_ref":"typing.Optional","kind":"Gdef"},"TypedDict":{".class":"SymbolTableNode","cross_ref":"typing.TypedDict","kind":"Gdef"},"__annotations__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"transformers.modeling_flash_attention_utils.__annotations__","name":"__annotations__","type":{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.dict"}}},"__doc__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"transformers.modeling_flash_attention_utils.__doc__","name":"__doc__","type":"builtins.str"}},"__file__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"transformers.modeling_flash_attention_utils.__file__","name":"__file__","type":"builtins.str"}},"__name__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"transformers.modeling_flash_attention_utils.__name__","name":"__name__","type":"builtins.str"}},"__package__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"transformers.modeling_flash_attention_utils.__package__","name":"__package__","type":"builtins.str"}},"__spec__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"transformers.modeling_flash_attention_utils.__spec__","name":"__spec__","type":"_frozen_importlib.ModuleSpec"}},"_fa3_pad_input":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["hidden_states","indices","batch","seqlen"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._fa3_pad_input","name":"_fa3_pad_input","type":null}},"_fa3_unpad_input":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,1],"arg_names":["hidden_states","attention_mask","unused_mask"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._fa3_unpad_input","name":"_fa3_unpad_input","type":null}},"_flash_attention_forward":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,4],"arg_names":["query_states","key_states","value_states","attention_mask","query_length","is_causal","dropout","position_ids","softmax_scale","sliding_window","use_top_left_mask","softcap","deterministic","cu_seq_lens_q","cu_seq_lens_k","max_length_q","max_length_k","target_dtype","attn_implementation","kwargs"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._flash_attention_forward","name":"_flash_attention_forward","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,4],"arg_names":["query_states","key_states","value_states","attention_mask","query_length","is_causal","dropout","position_ids","softmax_scale","sliding_window","use_top_left_mask","softcap","deterministic","cu_seq_lens_q","cu_seq_lens_k","max_length_q","max_length_k","target_dtype","attn_implementation","kwargs"],"arg_types":["torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},"builtins.int","builtins.bool","builtins.float",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.float",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false},"builtins.bool",{".class":"UnionType","items":["builtins.float",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.bool",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._C.LongTensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._C.LongTensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._C.dtype",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.str",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_flash_attention_forward","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_flash_supports_window_size":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready","is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils._flash_supports_window_size","name":"_flash_supports_window_size","type":"builtins.bool"}},"_get_unpad_data":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["attention_mask"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._get_unpad_data","name":"_get_unpad_data","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["attention_mask"],"arg_types":["torch._tensor.Tensor"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_get_unpad_data","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor","builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_index_first_axis":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["tensor","indices"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._index_first_axis","name":"_index_first_axis","type":null}},"_prepare_flash_attention_from_position_ids":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["query","key","value","position_ids"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._prepare_flash_attention_from_position_ids","name":"_prepare_flash_attention_from_position_ids","type":null}},"_upad_input":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0],"arg_names":["query_layer","key_layer","value_layer","attention_mask","query_length","unpad_input_func"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils._upad_input","name":"_upad_input","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0],"arg_names":["query_layer","key_layer","value_layer","attention_mask","query_length","unpad_input_func"],"arg_types":["torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor","builtins.int",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_upad_input","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"apply_rotary_emb":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.apply_rotary_emb","name":"apply_rotary_emb","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.apply_rotary_emb","source_any":null,"type_of_any":3}}},"deterministic_g":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.deterministic_g","name":"deterministic_g","type":{".class":"NoneType"}}},"fa_peft_integration_check":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,1],"arg_names":["query","key","value","target_dtype"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils.fa_peft_integration_check","name":"fa_peft_integration_check","type":{".class":"CallableType","arg_kinds":[0,0,0,1],"arg_names":["query","key","value","target_dtype"],"arg_types":["torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._C.dtype",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"fa_peft_integration_check","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"flash_241":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.flash_241","name":"flash_241","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"flash_attn_2_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_2_func","name":"flash_attn_2_func","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.flash_attn_2_func","source_any":null,"type_of_any":3}}},"flash_attn_2_varlen_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_2_varlen_func","name":"flash_attn_2_varlen_func","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.flash_attn_2_varlen_func","source_any":null,"type_of_any":3}}},"flash_attn_3_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_3_func","name":"flash_attn_3_func","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.flash_attn_3_func","source_any":null,"type_of_any":3}}},"flash_attn_3_varlen_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_3_varlen_func","name":"flash_attn_3_varlen_func","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.flash_attn_3_varlen_func","source_any":null,"type_of_any":3}}},"flash_attn_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_func","name":"flash_attn_func","type":{".class":"UnionType","items":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2},{".class":"NoneType"}],"uses_pep604_syntax":false}}},"flash_attn_supports_top_left_mask":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_supports_top_left_mask","name":"flash_attn_supports_top_left_mask","type":null}},"flash_attn_varlen_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.flash_attn_varlen_func","name":"flash_attn_varlen_func","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}}},"inspect":{".class":"SymbolTableNode","cross_ref":"inspect","kind":"Gdef"},"is_flash_attn_2_available":{".class":"SymbolTableNode","cross_ref":"transformers.utils.import_utils.is_flash_attn_2_available","kind":"Gdef"},"is_flash_attn_3_available":{".class":"SymbolTableNode","cross_ref":"transformers.utils.import_utils.is_flash_attn_3_available","kind":"Gdef"},"is_flash_attn_available":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils.is_flash_attn_available","name":"is_flash_attn_available","type":null}},"is_flash_attn_greater_or_equal":{".class":"SymbolTableNode","cross_ref":"transformers.utils.import_utils.is_flash_attn_greater_or_equal","kind":"Gdef"},"is_flash_attn_greater_or_equal_2_10":{".class":"SymbolTableNode","cross_ref":"transformers.utils.import_utils.is_flash_attn_greater_or_equal_2_10","kind":"Gdef"},"is_torch_npu_available":{".class":"SymbolTableNode","cross_ref":"transformers.utils.import_utils.is_torch_npu_available","kind":"Gdef"},"logger":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.logger","name":"logger","type":"logging.Logger"}},"logging":{".class":"SymbolTableNode","cross_ref":"transformers.utils.logging","kind":"Gdef"},"os":{".class":"SymbolTableNode","cross_ref":"os","kind":"Gdef"},"pad_input":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.pad_input","name":"pad_input","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}}},"pad_input_fa2":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.pad_input_fa2","name":"pad_input_fa2","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.pad_input_fa2","source_any":null,"type_of_any":3}}},"pad_input_fa3":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.pad_input_fa3","name":"pad_input_fa3","type":{".class":"CallableType","arg_kinds":[0,0,0,0],"arg_names":["hidden_states","indices","batch","seqlen"],"arg_types":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":true,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":null,"ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"prepare_fa2_from_position_ids":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[2,4],"arg_names":["args","kwargs"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"transformers.modeling_flash_attention_utils.prepare_fa2_from_position_ids","name":"prepare_fa2_from_position_ids","type":null}},"torch":{".class":"SymbolTableNode","cross_ref":"torch","kind":"Gdef"},"unpad_input":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.unpad_input","name":"unpad_input","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}}},"unpad_input_fa2":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_suppressed_import","is_ready","is_inferred"],"fullname":"transformers.modeling_flash_attention_utils.unpad_input_fa2","name":"unpad_input_fa2","type":{".class":"AnyType","missing_import_name":"transformers.modeling_flash_attention_utils.unpad_input_fa2","source_any":null,"type_of_any":3}}},"unpad_input_fa3":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"transformers.modeling_flash_attention_utils.unpad_input_fa3","name":"unpad_input_fa3","type":{".class":"CallableType","arg_kinds":[0,0,1],"arg_names":["hidden_states","attention_mask","unused_mask"],"arg_types":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":true,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":null,"ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"warnings":{".class":"SymbolTableNode","cross_ref":"warnings","kind":"Gdef"}},"path":"/Users/hz/Projects/python/nsfw/.venv/lib/python3.13/site-packages/transformers/modeling_flash_attention_utils.py"}